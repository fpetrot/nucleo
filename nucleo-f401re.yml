platforms:
  nucleo-f401re:
    description: Affordable and flexible platform to ease prototyping using a STM32F401RET6 microcontroller
    components:
      bus:
        type: simple-bus

      cpu:
        type: cpu-arm-v7m
        cpu-model: cortex-m4
        num-irq: 52
        bindings:
          mem: bus

      flash:
        type: memory
        size: &mem_size 512K
        bindings:
          mem:
            peer: bus
            address: { &mem_start 0x80000000: *mem_size }

      sram:
        type: memory
        size: &mem_size 96K
        bindings:
          mem:
            peer: bus
            address: { &mem_start 0x20000000: *mem_size }

#      irq-ctrl:
#        type: nvic
#        bindings:
#          mem:
#            peer: bus
#            address: { 0x2000b200: 0x200 }
#          cpu-irq: cpu.irq
#          cpu-fiq: cpu.fiq
#
#      sys-timer:
#        type: bcm2835-system-timer
#        bindings:
#          mem:
#            peer: bus
#            address: { 0x20003000: 0x1c }
#          irq: irq-ctrl.irq3
#
#      usart:
#        type: uart-pl011
#        bindings:
#          mem:
#            peer: bus
#            address: { 0x20201000: 0x1000 }
#          irq: irq-ctrl.irq57

      gpio-a:
        type: rm0368-gpio
        moder: 0x0C000000
        ospeedr: 0x0C000000
        pupdr: 0x64000000
        bindings:
          mem:
            peer: bus
            address: { 0x40020000: 0x400 }

      gpio-b:
        type: rm0368-gpio
        moder: 0x00000280
        ospeedr: 0x000000C0
        pupdr: 0x00000100
        bindings:
          mem:
            peer: bus
            address: { 0x40020400: 0x400 }

      gpio-c:
        type: rm0368-gpio
        bindings:
          mem:
            peer: bus
            address: { 0x40020800: 0x400 }

      gpio-d:
        type: rm0368-gpio
        bindings:
          mem:
            peer: bus
            address: { 0x40020C00: 0x400 }

      gpio-e:
        type: rm0368-gpio
        bindings:
          mem:
            peer: bus
            address: { 0x40021000: 0x400 }

      gpio-h:
        type: rm0368-gpio
        bindings:
          mem:
            peer: bus
            address: { 0x40021C00: 0x400 }

    plugins:
      bootloader:
        type: bootloader
        architecture: arm
        ram-start: *mem_start
        kernel-load-addr: 0x00008000
        machine-id: 0x00000c42
        dtb-load-addr: 0x00000100
